# Faucet 定时调用工具

这个工具可以定时调用 Sui faucet 来获取测试网代币，包含智能重试机制。

## 功能特性

- ⏰ 可配置的定时调用间隔（默认1小时）
- 🔄 自动重试机制：遇到429限流时，5分钟后自动重试
- 📱 Discord 通知：成功、失败、限流等状态都会发送通知
- 🛡️ 内置限流保护：避免过于频繁的请求

## 环境变量配置

在 `.env` 文件中设置以下变量：

```bash
# Sui 网络配置
NETWORK=testnet

# 你的钱包地址
ADDRESS=your_wallet_address_here

# Discord Webhook URL (可选，用于发送通知)
DISCORD_WEBHOOK_URL=your_discord_webhook_url_here

# 定时调用间隔 (毫秒，默认1小时 = 3600000)
# 可选值示例：
# 30分钟 = 1800000
# 1小时 = 3600000  
# 2小时 = 7200000
# 6小时 = 21600000
SCHEDULE_INTERVAL=3600000
```

## 使用方法

### 1. 安装依赖
```bash
npm install
```

### 2. 配置环境变量
复制 `.env.example` 为 `.env` 并填入你的配置

### 3. 运行程序
```bash
# 使用 TypeScript 运行
npx ts-node src/faucet.ts

# 或者编译后运行
npm run build
node dist/faucet.js
```

## 运行示例

```
配置信息:
- 网络: testnet
- 地址: 0x1234...
- 调用间隔: 60 分钟
- 重试延迟: 10 分钟
开始定时调用 faucet，间隔: 60 分钟
[2024/1/1 12:00:00] 开始执行 faucet 请求...
recipient: 0x1234...
[2024/1/1 12:00:01] 领取成功： {...}
程序已启动，按 Ctrl+C 停止...
```

## 重试机制

当遇到以下情况时，程序会自动重试：

1. **429 限流错误**：官方 faucet 限流，10分钟后重试
2. **请求太频繁**：本地限流保护，10分钟后重试

## Discord 通知

如果配置了 `DISCORD_WEBHOOK_URL`，程序会发送以下通知：

- ✅ **成功通知**：包含时间、地址、结果
- ⚠️ **限流通知**：包含重试时间信息
- ❌ **失败通知**：包含错误详情

## 停止程序

按 `Ctrl+C` 可以停止程序运行。

## 注意事项

1. 确保你的钱包地址正确
2. 不要设置过于频繁的调用间隔，避免触发官方限流
3. 建议在服务器上运行，保持24小时在线
4. 可以配合 `pm2` 等进程管理工具使用
